<?xml version="1.0" encoding="utf-8"?>
<Override>
  <Items>
    <Item name="Gardening Sprinkler" identifier="he-sprinkler" tags="talentitem,sprinkler" linkable="true" category="Misc" subcategory="Container" description="" canflipx="false" pickdistance="150" waterproof="false" isshootable="true" scale="0.5">
      <Sprite texture="%ModDir:2954998725%/Content/Items/Fabricators/Fabricators.png" sourcerect="0,1486,156,106" origin="0.5,0.5" />
      <Sprite texture="%ModDir:2954998725%/Content/Items/Fabricators/Fabricators.png" depth="0.591" sourcerect="0,1486,156,106" origin="0.5,0.5" />
      <ContainedSprite texture="%ModDir:2954998725%/Content/Items/Fabricators/Fabricators.png" usewhenattached="true" decorativespritebehavior="HideWhenNotVisible" depth="0.805" sourcerect="0,1234,106,251" origin="0.5,0.5" />
      <Body radius="50" width="90" density="25" />
      <Deconstruct time="10">
        <Item identifier="steel" amount="1" />
        <Item identifier="plastic" amount="1" />
      </Deconstruct>
      <Fabricate suitablefabricators="fabricator" requiredtime="60" requiresrecipe="true" amount="1">
        <RequiredSkill identifier="mechanical" level="35" />
        <RequiredItem identifier="fpgacircuit" amount="1" />
        <RequiredItem identifier="steel" amount="2" />
        <RequiredItem identifier="plastic" amount="3" />
      </Fabricate>
      <!--PowerContainer charge used to keep track of time to only water every 15min. Multiply by 100 and check for >99% because charge rate drops near 100%-->
      <PowerContainer capacity="600" charge="600" maxrechargespeed="0" rechargespeed="0" canbeselected="false">
        <StatusEffect type="OnNotContained" target="This">
          <Conditional chargepercentage="0" />
          <UseItem />
        </StatusEffect>
      </PowerContainer>
      <!-- When active, water plants and reduce condition of keg. Reset charge to max after 10 seconds -->
      <!-- PLANTS HAVE AROUND 400 HEALTH. 20 CONDITION FOR 10 SECONDS IS ABOUT HALF OF THEIR TOTAL HEALTH -->
      <RepairTool extinguishamount="50.0" range="300" spread="180" unskilledspread="180" barrelpos="0,0" repairthroughholes="true" characterusable="false" requireaimtouse="false" usablein="air" hititems="true" repairmultiple="true" wateramount="100" barrelrotation="270">
        <RequiredItem items="he-kegwater" type="Contained" />
        <StatusEffect type="OnUse" target="This" charge="9999" targetitemcomponent="PowerContainer" delay="10" interval="11" stackable="false" setvalue="true" />
        <StatusEffect type="OnUse" target="Contained" condition="-2.0" offset="0,-50">
          <RequiredItem items="he-kegwater" type="Contained" />
          <ParticleEmitter particle="waterdrop" anglemin="0" anglemax="360" velocitymin="100.0" velocitymax="300.0" particlespersecond="50" />
          <Sound file="%ModDir:2954998725%/Content/Sounds/Items/Drinks/DrainLiquid.ogg" volume="4" range="500" loop="true" />
        </StatusEffect>
        <StatusEffect type="OnNotContained" target="This" setvalue="true" requireaimtouse="false" />
        <StatusEffect type="OnContained" target="This" setvalue="true" requireaimtouse="true" />
        <!-- Cursed channel switching to shift the sprinkler barrel position from left to right TODO: replace this with a better solution when possible, like rotating the barrel instead -->
        <!-- <StatusEffect type="OnUse" target="This" barrelrotation="720" /> -->
        <!-- <ParticleEmitter particle="plasma" particlespersecond="50" copyentityangle="true"/> -->
        <StatusEffect type="OnUse" target="This" interval="1" barrelpos="-70,0" channel="1" setvalue="true" duration="1" stackable="false">
          <Conditional channel="eq 0" />
        </StatusEffect>
        <StatusEffect type="OnUse" target="This" interval="1" barrelpos="0,0" channel="2" setvalue="true" duration="1" stackable="false">
          <Conditional channel="eq 1" />
        </StatusEffect>
        <StatusEffect type="OnUse" target="This" interval="1" barrelpos="70,0" channel="0" setvalue="true" duration="1" stackable="false">
          <Conditional channel="eq 2" />
        </StatusEffect>
      </RepairTool>
      <!--WifiComponent is used to trigger the StatusEffects that alter the barrelpos one after another and loop them back by keeping track of and adjusting the channel value-->
      <WifiComponent canbeselected="false" allowingameediting="false" channel="0" range="0" linktochat="false" />
      <ItemContainer selectkey="Select" capacity="0" canbeselected="true" hideitems="false" itempos="78,5" ShowContainedStateIndicator="false" slotsperrow="3" keepopenwhenequipped="false" movableframe="true">
        <GuiFrame relativesize="0.15,0.30" anchor="Center" relativeoffset="0,0" style="ItemUI" msg="ItemMsgInteractSelect" />
        <TextBox text="Set timer" targetitemcomponent="PowerContainer" propertyname="capacity" maxtextlength="3" ShouldSetProperty="true" />
        <!--Watertank Icon-->
        <SlotIcon texture="%ModDir:2954998725%/Content/UI/HE-IconsAtlas.png" sourcerect="237,0,85,85" origin="0.5,0.5" />
        <!--Watertank Slot-->
        <SubContainer capacity="1" maxstacksize="1" slot="0">
          <Containable items="he-kegwater,emptykeg" />
        </SubContainer>
        <!--Play a sound when opening the items interface-->
        <StatusEffect type="OnPicked" target="this">
          <Sound file="%ModDir:2954998725%/Content/Sounds/Items/Fabricators/hydroponics_interact.ogg" volume="1" range="300" selectionmode="random" />
        </StatusEffect>
      </ItemContainer>
      <ConnectionPanel selectkey="Action" canbeselected="true" hudpriority="10" msg="ItemMsgRewireScrewdriver">
        <GuiFrame relativesize="0.2,0.32" minsize="400,350" maxsize="480,420" anchor="Center" style="ConnectionPanel" />
        <RequiredSkill identifier="electrical" level="55" />
        <StatusEffect type="OnFailure" target="Character" targetlimbs="LeftHand,RightHand">
          <Sound file="Content/Sounds/Damage/Electrocution1.ogg" range="1000" />
          <Explosion range="100.0" stun="0" force="5.0" flames="false" shockwave="false" sparks="true" underwaterbubble="false" />
          <Affliction identifier="stun" strength="4" />
          <Affliction identifier="burn" strength="5" />
        </StatusEffect>
        <!--Trigger interact sound when opening the connection panel-->
        <StatusEffect type="OnPicked" target="this">
          <Sound file="%ModDir:2954998725%/Content/Sounds/Items/Electricity/junctionbox_interact.ogg" volume="1" range="300" />
        </StatusEffect>
        <RequiredItem items="screwdriver" type="Equipped" />
        <input name="power_in" displayname="connection.powerin" />
        <output name="charge" displayname="connection.batterychargestatusout" />
      </ConnectionPanel>
      <Holdable canbepicked="true" selectkey="Select" pickkey="Action" slots="RightHand+LeftHand" holdpos="0,-50" handle1="-10,-20" handle2="10,-20" holdangle="45" msg="ItemMsgDetachWrench" PickingTime="5.0" aimpos="65,-10" attachable="true" aimable="true">
        <RequiredItem items="wrench" type="Equipped" />
        <StatusEffect target="This" type="OnContained">
          <Conditional attached="false" targetitemcomponentname="Holdable" />
          <DropContainedItems />
        </StatusEffect>
      </Holdable>
      <CustomInterface canbeselected="true" drawhudwhenequipped="false">
        <GuiFrame style="ItemUI" absoluteoffset="0,-100" anchor="Center" relativesize="0.15,0.12" />
        <TickBox text="interaction.onoff">
          <StatusEffect type="OnUse" target="This" StatusEffectTags="sprinkleractive" duration="0.1" stackable="false" />
          <StatusEffect type="OnSecondaryUse" target="This" StatusEffectTags="sprinklerinactive" duration="0.1" />
        </TickBox>
        <TextBox text="Set Cooldown" propertyname="capacity" targetitemcomponent="PowerContainer" maxtextlength="3" />
      </CustomInterface>
      <!-- Keg Not Empty -->
      <LightComponent range="0.0" lightcolor="100,255,50,111" flicker="0.1" flickerspeed="0.5" IsOn="false" castshadows="false" alphablend="false" allowingameediting="false" powerconsumption="50">
        <sprite texture="%ModDir:2954998725%/Content/Items/Fabricators/Fabricators.png" sourcerect="106,1234,105,251" depth="0.1" origin="0.5,0.5" alpha="1.0" />
        <IsActiveConditional hasstatustag="sprinkleractive" />
        <IsActiveConditional targetcontaineditem="true" conditionpercentage="gt 0" />
        <StatusEffect type="OnActive" target="This" interval="1" Charge="-1" disabledeltatime="true">
          <Conditional chargepercentage="gt 0" targetitemcomponent="PowerContainer" />
        </StatusEffect>
      </LightComponent>
      <!-- Keg <20% -->
      <LightComponent range="0.0" lightcolor="255,0,0,111" blinkfrequency="1" pulseamount="0.0" pulsefrequency="0" flicker="0.1" flickerspeed="0.5" IsOn="false" castshadows="false" alphablend="false" allowingameediting="false" powerconsumption="5">
        <sprite texture="%ModDir:2954998725%/Content/Items/Fabricators/Fabricators.png" sourcerect="106,1234,105,251" depth="0.1" origin="0.5,0.5" alpha="1.0" />
        <IsActiveConditional hasstatustag="sprinkleractive" />
        <IsActiveConditional targetcontaineditem="true" conditionpercentage="lte 20" />
      </LightComponent>
    </Item>
  </Items>
</Override>